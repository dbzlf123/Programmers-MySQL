//https://school.programmers.co.kr/learn/courses/30/lessons/131532?language=mysql


//MySQL
SELECT YEAR(b.SALES_DATE) as YEAR, MONTH(b.SALES_DATE) as MONTH, a.GENDER GENDER, COUNT(DISTINCT b.USER_ID) USERS
FROM USER_INFO a JOIN ONLINE_SALE b ON a.USER_ID = b.USER_ID
WHERE a.GENDER IS NOT NULL
GROUP BY YEAR, MONTH, GENDER
ORDER BY YEAR, MONTH, GENDER


//Oracle
SELECT TO_CHAR(b.SALES_DATE, 'YYYY') YEAR, TO_NUMBER(TO_CHAR(b.SALES_DATE, 'MM')) MONTH, a.GENDER GENDER, COUNT(DISTINCT b.USER_ID) USERS
FROM USER_INFO a JOIN ONLINE_SALE b ON a.USER_ID = b.USER_ID
WHERE a.GENDER IS NOT NULL
GROUP BY TO_CHAR(b.SALES_DATE, 'YYYY'), TO_NUMBER(TO_CHAR(b.SALES_DATE, 'MM')), a.GENDER
ORDER BY YEAR, MONTH, GENDER
